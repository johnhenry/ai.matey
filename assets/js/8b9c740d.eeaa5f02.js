"use strict";(globalThis.webpackChunkai_matey_docs=globalThis.webpackChunkai_matey_docs||[]).push([[212],{1184:(e,n,r)=>{r.d(n,{R:()=>s,x:()=>d});var t=r(4041);const i={},a=t.createContext(i);function s(e){const n=t.useContext(a);return t.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function d(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:s(e.components),t.createElement(a.Provider,{value:n},e.children)}},3281:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>o,contentTitle:()=>d,default:()=>h,frontMatter:()=>s,metadata:()=>t,toc:()=>l});const t=JSON.parse('{"id":"getting-started/core-concepts","title":"Core Concepts","description":"Understanding the four fundamental concepts in ai.matey: Bridge, Router, Middleware, and Intermediate Representation (IR).","source":"@site/docs/getting-started/core-concepts.md","sourceDirName":"getting-started","slug":"/getting-started/core-concepts","permalink":"/ai.matey/getting-started/core-concepts","draft":false,"unlisted":false,"editUrl":"https://github.com/johnhenry/ai.matey/tree/main/packages/ai.matey.docs/docs/getting-started/core-concepts.md","tags":[],"version":"current","frontMatter":{},"sidebar":"docs","previous":{"title":"Quick Start","permalink":"/ai.matey/getting-started/quick-start"},"next":{"title":"Your First Bridge - Step-by-Step Tutorial","permalink":"/ai.matey/getting-started/your-first-bridge"}}');var i=r(1085),a=r(1184);const s={},d="Core Concepts",o={},l=[{value:"The Problem ai.matey Solves",id:"the-problem-aimatey-solves",level:2},{value:"Architecture Overview",id:"architecture-overview",level:2},{value:"1. Intermediate Representation (IR)",id:"1-intermediate-representation-ir",level:2},{value:"IR Structure",id:"ir-structure",level:3},{value:"Why IR Matters",id:"why-ir-matters",level:3},{value:"Example: IR in Action",id:"example-ir-in-action",level:3},{value:"2. Bridge",id:"2-bridge",level:2},{value:"Bridge Pattern",id:"bridge-pattern",level:3},{value:"Frontend Adapters",id:"frontend-adapters",level:3},{value:"Backend Adapters",id:"backend-adapters",level:3},{value:"Bridge with Middleware",id:"bridge-with-middleware",level:3},{value:"3. Router",id:"3-router",level:2},{value:"Basic Router",id:"basic-router",level:3},{value:"Routing Strategies",id:"routing-strategies",level:3},{value:"1. Round Robin",id:"1-round-robin",level:4},{value:"2. Model-Based",id:"2-model-based",level:4},{value:"3. Custom Strategy",id:"3-custom-strategy",level:4},{value:"4. Fallback Chain",id:"4-fallback-chain",level:4},{value:"Advanced Routing",id:"advanced-routing",level:3},{value:"Parallel Dispatch",id:"parallel-dispatch",level:4},{value:"Health Checking",id:"health-checking",level:4},{value:"4. Middleware",id:"4-middleware",level:2},{value:"Middleware Pattern",id:"middleware-pattern",level:3},{value:"Built-in Middleware",id:"built-in-middleware",level:3},{value:"1. Logging",id:"1-logging",level:4},{value:"2. Caching",id:"2-caching",level:4},{value:"3. Retry",id:"3-retry",level:4},{value:"4. Transform",id:"4-transform",level:4},{value:"5. Cost Tracking",id:"5-cost-tracking",level:4},{value:"6. OpenTelemetry",id:"6-opentelemetry",level:4},{value:"Custom Middleware",id:"custom-middleware",level:3},{value:"Middleware Order",id:"middleware-order",level:3},{value:"Putting It All Together",id:"putting-it-all-together",level:2},{value:"Key Takeaways",id:"key-takeaways",level:2},{value:"Next Steps",id:"next-steps",level:2}];function c(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",hr:"hr",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,a.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"core-concepts",children:"Core Concepts"})}),"\n",(0,i.jsxs)(n.p,{children:["Understanding the four fundamental concepts in ai.matey: ",(0,i.jsx)(n.strong,{children:"Bridge"}),", ",(0,i.jsx)(n.strong,{children:"Router"}),", ",(0,i.jsx)(n.strong,{children:"Middleware"}),", and ",(0,i.jsx)(n.strong,{children:"Intermediate Representation (IR)"}),"."]}),"\n",(0,i.jsx)(n.h2,{id:"the-problem-aimatey-solves",children:"The Problem ai.matey Solves"}),"\n",(0,i.jsx)(n.p,{children:"Every AI provider has their own API format:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:'// OpenAI format\n{\n  model: "gpt-4",\n  messages: [{ role: "user", content: "Hello" }],\n  max_tokens: 100\n}\n\n// Anthropic format\n{\n  model: "claude-3-5-sonnet-20241022",\n  messages: [{ role: "user", content: "Hello" }],\n  max_tokens: 100\n}\n\n// Gemini format\n{\n  model: "gemini-1.5-flash",\n  contents: [{ role: "user", parts: [{ text: "Hello" }] }],\n  generationConfig: { maxOutputTokens: 100 }\n}\n'})}),"\n",(0,i.jsxs)(n.p,{children:["Switching providers means rewriting your code. ai.matey solves this by using an ",(0,i.jsx)(n.strong,{children:"Intermediate Representation"})," that all providers can convert to/from."]}),"\n",(0,i.jsx)(n.h2,{id:"architecture-overview",children:"Architecture Overview"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502   Your Code     \u2502  Write in any format (OpenAI, Anthropic, etc.)\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n         \u2502\n         \u25bc\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 Frontend Adapter\u2502  Parses your input format\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n         \u2502\n         \u25bc\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502  IR (Universal) \u2502  Provider-agnostic format\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n         \u2502\n         \u25bc\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 Backend Adapter \u2502  Converts IR to provider format\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n         \u2502\n         \u25bc\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502  AI Provider    \u2502  OpenAI, Anthropic, Gemini, etc.\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n"})}),"\n",(0,i.jsx)(n.h2,{id:"1-intermediate-representation-ir",children:"1. Intermediate Representation (IR)"}),"\n",(0,i.jsxs)(n.p,{children:["The ",(0,i.jsx)(n.strong,{children:"IR"})," is a universal format that all providers can convert to and from. It's the core of ai.matey's portability."]}),"\n",(0,i.jsx)(n.h3,{id:"ir-structure",children:"IR Structure"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"interface IRChatCompletionRequest {\n  model: string;\n  messages: Array<{\n    role: 'system' | 'user' | 'assistant';\n    content: string;\n  }>;\n  temperature?: number;\n  max_tokens?: number;\n  stream?: boolean;\n  // ... other standard fields\n}\n"})}),"\n",(0,i.jsx)(n.h3,{id:"why-ir-matters",children:"Why IR Matters"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["\u2705 ",(0,i.jsx)(n.strong,{children:"Provider-agnostic"}),": Same format works with all backends"]}),"\n",(0,i.jsxs)(n.li,{children:["\u2705 ",(0,i.jsx)(n.strong,{children:"Stable"}),": Your code doesn't break when providers change their APIs"]}),"\n",(0,i.jsxs)(n.li,{children:["\u2705 ",(0,i.jsx)(n.strong,{children:"Extensible"}),": Add new providers without changing your code"]}),"\n",(0,i.jsxs)(n.li,{children:["\u2705 ",(0,i.jsx)(n.strong,{children:"Testable"}),": Mock backends easily with consistent interfaces"]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"example-ir-in-action",children:"Example: IR in Action"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"// Your code uses IR directly (no frontend adapter needed)\nimport { AnthropicBackendAdapter } from 'ai.matey.backend/anthropic';\n\nconst backend = new AnthropicBackendAdapter({\n  apiKey: process.env.ANTHROPIC_API_KEY\n});\n\n// IR format request\nconst irRequest = {\n  model: 'claude-3-5-sonnet-20241022',\n  messages: [\n    { role: 'user', content: 'Hello!' }\n  ],\n  temperature: 0.7,\n  max_tokens: 100\n};\n\n// Execute with IR\nconst response = await backend.execute(irRequest);\n"})}),"\n",(0,i.jsx)(n.h2,{id:"2-bridge",children:"2. Bridge"}),"\n",(0,i.jsxs)(n.p,{children:["The ",(0,i.jsx)(n.strong,{children:"Bridge"})," connects a ",(0,i.jsx)(n.strong,{children:"Frontend Adapter"})," (input format) with a ",(0,i.jsx)(n.strong,{children:"Backend Adapter"})," (AI provider)."]}),"\n",(0,i.jsx)(n.h3,{id:"bridge-pattern",children:"Bridge Pattern"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"import { Bridge } from 'ai.matey.core';\nimport { OpenAIFrontendAdapter } from 'ai.matey.frontend/openai';\nimport { AnthropicBackendAdapter } from 'ai.matey.backend/anthropic';\n\nconst bridge = new Bridge(\n  new OpenAIFrontendAdapter(),    // Accept OpenAI format\n  new AnthropicBackendAdapter({   // Execute on Anthropic\n    apiKey: process.env.ANTHROPIC_API_KEY\n  })\n);\n"})}),"\n",(0,i.jsx)(n.h3,{id:"frontend-adapters",children:"Frontend Adapters"}),"\n",(0,i.jsx)(n.p,{children:"Frontend adapters parse different input formats into IR:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"OpenAIFrontendAdapter"})," - OpenAI's chat completion format"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"AnthropicFrontendAdapter"})," - Anthropic's messages API format"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"GeminiFrontendAdapter"})," - Google Gemini's format"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"MistralFrontendAdapter"})," - Mistral's format"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"GenericFrontendAdapter"})," - Already in IR format"]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"backend-adapters",children:"Backend Adapters"}),"\n",(0,i.jsx)(n.p,{children:"Backend adapters convert IR to provider-specific formats:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"24 different providers"})," (OpenAI, Anthropic, Gemini, Ollama, Groq, etc.)"]}),"\n",(0,i.jsx)(n.li,{children:"Each handles API specifics (authentication, rate limits, retries)"}),"\n",(0,i.jsxs)(n.li,{children:["Consistent interface: ",(0,i.jsx)(n.code,{children:"execute()"})," and ",(0,i.jsx)(n.code,{children:"executeStream()"})]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"bridge-with-middleware",children:"Bridge with Middleware"}),"\n",(0,i.jsx)(n.p,{children:"Add middleware to enhance functionality:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"import { createLoggingMiddleware } from 'ai.matey.middleware';\n\nconst bridge = new Bridge(\n  new OpenAIFrontendAdapter(),\n  new AnthropicBackendAdapter({ apiKey }),\n  [\n    createLoggingMiddleware({ level: 'info' })\n  ]\n);\n"})}),"\n",(0,i.jsx)(n.h2,{id:"3-router",children:"3. Router"}),"\n",(0,i.jsxs)(n.p,{children:["The ",(0,i.jsx)(n.strong,{children:"Router"})," routes requests to multiple backends based on strategies."]}),"\n",(0,i.jsx)(n.h3,{id:"basic-router",children:"Basic Router"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"import { createRouter } from 'ai.matey.core';\nimport { OpenAIBackendAdapter } from 'ai.matey.backend/openai';\nimport { AnthropicBackendAdapter } from 'ai.matey.backend/anthropic';\n\nconst router = createRouter({\n  routingStrategy: 'round-robin'\n})\n  .register('openai', new OpenAIBackendAdapter({ apiKey: openaiKey }))\n  .register('anthropic', new AnthropicBackendAdapter({ apiKey: anthropicKey }));\n\n// Router is a backend, so use it in a Bridge\nconst bridge = new Bridge(\n  new OpenAIFrontendAdapter(),\n  router\n);\n"})}),"\n",(0,i.jsx)(n.h3,{id:"routing-strategies",children:"Routing Strategies"}),"\n",(0,i.jsx)(n.h4,{id:"1-round-robin",children:"1. Round Robin"}),"\n",(0,i.jsx)(n.p,{children:"Distribute load evenly:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"const router = createRouter({\n  routingStrategy: 'round-robin'\n});\n\n// Request 1 \u2192 openai\n// Request 2 \u2192 anthropic\n// Request 3 \u2192 openai\n// ...\n"})}),"\n",(0,i.jsx)(n.h4,{id:"2-model-based",children:"2. Model-Based"}),"\n",(0,i.jsx)(n.p,{children:"Route by model name:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"const router = createRouter({\n  routingStrategy: 'model-based'\n})\n  .register('openai', openaiBackend)\n  .register('anthropic', anthropicBackend);\n\n// gpt-4 \u2192 openai\n// claude-3 \u2192 anthropic\n"})}),"\n",(0,i.jsx)(n.h4,{id:"3-custom-strategy",children:"3. Custom Strategy"}),"\n",(0,i.jsx)(n.p,{children:"Route based on custom logic:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"const router = createRouter({\n  routingStrategy: (request) => {\n    // Route expensive queries to powerful models\n    const isComplex = request.messages[0].content.length > 1000;\n    return isComplex ? 'openai' : 'anthropic';\n  }\n});\n"})}),"\n",(0,i.jsx)(n.h4,{id:"4-fallback-chain",children:"4. Fallback Chain"}),"\n",(0,i.jsx)(n.p,{children:"Automatic failover:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"router.setFallbackChain(['openai', 'anthropic', 'groq']);\n\n// Try openai \u2192 if fails, try anthropic \u2192 if fails, try groq\n"})}),"\n",(0,i.jsx)(n.h3,{id:"advanced-routing",children:"Advanced Routing"}),"\n",(0,i.jsx)(n.h4,{id:"parallel-dispatch",children:"Parallel Dispatch"}),"\n",(0,i.jsx)(n.p,{children:"Query multiple backends simultaneously:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"const results = await router.parallelDispatch(request, {\n  backends: ['openai', 'anthropic', 'gemini'],\n  strategy: 'all' // or 'first' or 'fastest'\n});\n\n// Get responses from all 3 providers for comparison\n"})}),"\n",(0,i.jsx)(n.h4,{id:"health-checking",children:"Health Checking"}),"\n",(0,i.jsx)(n.p,{children:"Monitor backend health:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"router.on('health-check', (backend, healthy) => {\n  console.log(`${backend} is ${healthy ? 'healthy' : 'unhealthy'}`);\n});\n\nconst health = await router.checkHealth();\n// { openai: true, anthropic: true, groq: false }\n"})}),"\n",(0,i.jsx)(n.h2,{id:"4-middleware",children:"4. Middleware"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Middleware"})," intercepts requests and responses to add functionality."]}),"\n",(0,i.jsx)(n.h3,{id:"middleware-pattern",children:"Middleware Pattern"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"import { Bridge } from 'ai.matey.core';\nimport {\n  createLoggingMiddleware,\n  createCachingMiddleware,\n  createRetryMiddleware\n} from 'ai.matey.middleware';\n\nconst bridge = new Bridge(\n  frontend,\n  backend,\n  [\n    createLoggingMiddleware({ level: 'info' }),\n    createCachingMiddleware({ ttl: 300000 }),  // 5 minutes\n    createRetryMiddleware({ maxAttempts: 3 })\n  ]\n);\n"})}),"\n",(0,i.jsx)(n.h3,{id:"built-in-middleware",children:"Built-in Middleware"}),"\n",(0,i.jsx)(n.h4,{id:"1-logging",children:"1. Logging"}),"\n",(0,i.jsx)(n.p,{children:"Log requests and responses:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"createLoggingMiddleware({\n  level: 'info',          // 'debug' | 'info' | 'warn' | 'error'\n  sanitize: true,         // Remove sensitive data\n  includeTimings: true    // Add timing information\n})\n"})}),"\n",(0,i.jsx)(n.h4,{id:"2-caching",children:"2. Caching"}),"\n",(0,i.jsx)(n.p,{children:"Cache responses for identical requests:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"createCachingMiddleware({\n  ttl: 300000,           // Cache for 5 minutes\n  maxSize: 100,          // Max 100 cached items\n  keyGenerator: (req) => JSON.stringify(req)  // Custom cache key\n})\n"})}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Performance"}),": 1000x+ speedup for duplicate requests!"]}),"\n",(0,i.jsx)(n.h4,{id:"3-retry",children:"3. Retry"}),"\n",(0,i.jsx)(n.p,{children:"Automatic retry with exponential backoff:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"createRetryMiddleware({\n  maxAttempts: 3,\n  initialDelay: 1000,    // Start with 1 second\n  maxDelay: 10000,       // Max 10 seconds\n  backoffMultiplier: 2,  // Double each time\n  retryOn: ['rate_limit', 'server_error']\n})\n"})}),"\n",(0,i.jsx)(n.h4,{id:"4-transform",children:"4. Transform"}),"\n",(0,i.jsx)(n.p,{children:"Modify requests/responses:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"createTransformMiddleware({\n  transformRequest: (req) => ({\n    ...req,\n    messages: [\n      { role: 'system', content: 'You are helpful' },\n      ...req.messages\n    ]\n  }),\n  transformResponse: (res) => {\n    // Modify response\n    return res;\n  }\n})\n"})}),"\n",(0,i.jsx)(n.h4,{id:"5-cost-tracking",children:"5. Cost Tracking"}),"\n",(0,i.jsx)(n.p,{children:"Track API costs:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"createCostTrackingMiddleware({\n  onCost: (cost, provider) => {\n    console.log(`${provider}: $${cost}`);\n  }\n})\n"})}),"\n",(0,i.jsx)(n.h4,{id:"6-opentelemetry",children:"6. OpenTelemetry"}),"\n",(0,i.jsx)(n.p,{children:"Add distributed tracing:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"createOpenTelemetryMiddleware({\n  serviceName: 'my-ai-service',\n  endpoint: 'http://localhost:4318'\n})\n"})}),"\n",(0,i.jsx)(n.h3,{id:"custom-middleware",children:"Custom Middleware"}),"\n",(0,i.jsx)(n.p,{children:"Create your own:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"interface Middleware {\n  onRequest?: (request: IRRequest) => IRRequest | Promise<IRRequest>;\n  onResponse?: (response: IRResponse) => IRResponse | Promise<IRResponse>;\n  onError?: (error: Error) => Error | Promise<Error>;\n}\n\nconst customMiddleware: Middleware = {\n  onRequest: async (request) => {\n    console.log('Request:', request);\n    return request;\n  },\n  onResponse: async (response) => {\n    console.log('Response:', response);\n    return response;\n  }\n};\n"})}),"\n",(0,i.jsx)(n.h3,{id:"middleware-order",children:"Middleware Order"}),"\n",(0,i.jsx)(n.p,{children:"Middleware executes in order:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"Request Flow:\n  [Logging] \u2192 [Transform] \u2192 [Retry] \u2192 [Backend]\n\nResponse Flow:\n  [Backend] \u2192 [Retry] \u2192 [Transform] \u2192 [Logging]\n"})}),"\n",(0,i.jsx)(n.h2,{id:"putting-it-all-together",children:"Putting It All Together"}),"\n",(0,i.jsx)(n.p,{children:"Here's a production-ready example combining all concepts:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"import { Bridge, createRouter } from 'ai.matey.core';\nimport { OpenAIFrontendAdapter } from 'ai.matey.frontend/openai';\nimport { OpenAIBackendAdapter } from 'ai.matey.backend/openai';\nimport { AnthropicBackendAdapter } from 'ai.matey.backend/anthropic';\nimport {\n  createLoggingMiddleware,\n  createCachingMiddleware,\n  createRetryMiddleware,\n  createCostTrackingMiddleware\n} from 'ai.matey.middleware';\n\n// 1. Create backends\nconst openaiBackend = new OpenAIBackendAdapter({\n  apiKey: process.env.OPENAI_API_KEY\n});\n\nconst anthropicBackend = new AnthropicBackendAdapter({\n  apiKey: process.env.ANTHROPIC_API_KEY\n});\n\n// 2. Create router with fallback\nconst router = createRouter({\n  routingStrategy: 'model-based'\n})\n  .register('openai', openaiBackend)\n  .register('anthropic', anthropicBackend)\n  .setFallbackChain(['openai', 'anthropic']);\n\n// 3. Add middleware\nconst middleware = [\n  createLoggingMiddleware({ level: 'info' }),\n  createCachingMiddleware({ ttl: 300000 }),\n  createRetryMiddleware({ maxAttempts: 3 }),\n  createCostTrackingMiddleware({\n    onCost: (cost, provider) => console.log(`Cost: $${cost}`)\n  })\n];\n\n// 4. Create bridge\nconst bridge = new Bridge(\n  new OpenAIFrontendAdapter(),\n  router,\n  middleware\n);\n\n// 5. Use it\nconst response = await bridge.chat({\n  model: 'gpt-4',\n  messages: [{ role: 'user', content: 'Hello!' }]\n});\n\n// Features you get:\n// \u2705 Write in OpenAI format\n// \u2705 Automatic provider routing\n// \u2705 Fallback if primary fails\n// \u2705 Request/response logging\n// \u2705 Response caching\n// \u2705 Automatic retries\n// \u2705 Cost tracking\n"})}),"\n",(0,i.jsx)(n.h2,{id:"key-takeaways",children:"Key Takeaways"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"IR (Intermediate Representation)"})," - Universal format that makes portability possible"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Bridge"})," - Connects frontend (input format) with backend (provider)"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Router"})," - Routes to multiple backends with strategies and fallback"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Middleware"})," - Adds logging, caching, retry, cost tracking, and more"]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"next-steps",children:"Next Steps"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:(0,i.jsx)(n.a,{href:"/getting-started/your-first-bridge",children:"Your First Bridge"})})," - Build a bridge step-by-step"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:(0,i.jsx)(n.a,{href:"/guides/architecture/ir-format",children:"IR Format Guide"})})," - Deep dive into IR format"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:(0,i.jsx)(n.a,{href:"/guides/testing",children:"Testing Guide"})})," - Testing your integrations"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:(0,i.jsx)(n.a,{href:"/packages/middleware",children:"Middleware Package"})})," - All middleware types"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:(0,i.jsx)(n.a,{href:"https://github.com/johnhenry/ai.matey/tree/main/packages/ai.matey.docs/examples",children:"Examples"})})," - Working code examples"]}),"\n"]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Ready to build?"})," Continue to ",(0,i.jsx)(n.a,{href:"/getting-started/your-first-bridge",children:"Your First Bridge"})," for a hands-on tutorial!"]})]})}function h(e={}){const{wrapper:n}={...(0,a.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(c,{...e})}):c(e)}}}]);