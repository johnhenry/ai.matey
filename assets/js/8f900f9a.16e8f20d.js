"use strict";(globalThis.webpackChunkai_matey_docs=globalThis.webpackChunkai_matey_docs||[]).push([[482],{1033:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>c,contentTitle:()=>d,default:()=>h,frontMatter:()=>i,metadata:()=>s,toc:()=>l});const s=JSON.parse('{"id":"packages/core","title":"ai.matey.core","description":"The foundational package providing the Bridge and Router classes - the heart of ai.matey\'s universal adapter system.","source":"@site/docs/packages/core.md","sourceDirName":"packages","slug":"/packages/core","permalink":"/ai.matey/packages/core","draft":false,"unlisted":false,"editUrl":"https://github.com/johnhenry/ai.matey/tree/main/packages/ai.matey.docs/docs/packages/core.md","tags":[],"version":"current","sidebarPosition":2,"frontMatter":{"sidebar_position":2},"sidebar":"docs","previous":{"title":"Packages Overview","permalink":"/ai.matey/packages/overview"},"next":{"title":"ai.matey.frontend","permalink":"/ai.matey/packages/frontend"}}');var t=r(1085),a=r(1184);const i={sidebar_position:2},d="ai.matey.core",c={},l=[{value:"Installation",id:"installation",level:2},{value:"Overview",id:"overview",level:2},{value:"Bridge",id:"bridge",level:2},{value:"Basic Usage",id:"basic-usage",level:3},{value:"Constructor",id:"constructor",level:3},{value:"Methods",id:"methods",level:3},{value:"chat()",id:"chat",level:4},{value:"chatStream()",id:"chatstream",level:4},{value:"use()",id:"use",level:4},{value:"Properties",id:"properties",level:3},{value:"frontendAdapter",id:"frontendadapter",level:4},{value:"backendAdapter",id:"backendadapter",level:4},{value:"Router",id:"router",level:2},{value:"Basic Usage",id:"basic-usage-1",level:3},{value:"Constructor",id:"constructor-1",level:3},{value:"RouterOptions",id:"routeroptions",level:3},{value:"Routing Strategies",id:"routing-strategies",level:3},{value:"Round-Robin",id:"round-robin",level:4},{value:"Priority",id:"priority",level:4},{value:"Random",id:"random",level:4},{value:"Weighted",id:"weighted",level:4},{value:"Custom",id:"custom",level:4},{value:"Methods",id:"methods-1",level:3},{value:"getBackendHealth()",id:"getbackendhealth",level:4},{value:"Events",id:"events",level:3},{value:"Middleware System",id:"middleware-system",level:2},{value:"Middleware Interface",id:"middleware-interface",level:3},{value:"Creating Custom Middleware",id:"creating-custom-middleware",level:3},{value:"Middleware Order",id:"middleware-order",level:3},{value:"Error Handling",id:"error-handling",level:2},{value:"Error Types",id:"error-types",level:3},{value:"Handling Errors",id:"handling-errors",level:3},{value:"TypeScript Types",id:"typescript-types",level:2},{value:"Key Interfaces",id:"key-interfaces",level:3},{value:"Best Practices",id:"best-practices",level:2},{value:"1. Reuse Instances",id:"1-reuse-instances",level:3},{value:"2. Use TypeScript",id:"2-use-typescript",level:3},{value:"3. Handle Errors",id:"3-handle-errors",level:3},{value:"4. Use Middleware",id:"4-use-middleware",level:3},{value:"See Also",id:"see-also",level:2}];function o(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,a.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.header,{children:(0,t.jsx)(n.h1,{id:"aimateycore",children:"ai.matey.core"})}),"\n",(0,t.jsx)(n.p,{children:"The foundational package providing the Bridge and Router classes - the heart of ai.matey's universal adapter system."}),"\n",(0,t.jsx)(n.h2,{id:"installation",children:"Installation"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"npm install ai.matey.core ai.matey.frontend ai.matey.backend\n"})}),"\n",(0,t.jsx)(n.h2,{id:"overview",children:"Overview"}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.code,{children:"ai.matey.core"})," provides two main classes:"]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Bridge"}),": Connects a single frontend adapter to a single backend adapter"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Router"}),": Connects a frontend adapter to multiple backend adapters with intelligent routing"]}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"bridge",children:"Bridge"}),"\n",(0,t.jsx)(n.h3,{id:"basic-usage",children:"Basic Usage"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-typescript",children:"import { Bridge } from 'ai.matey.core';\nimport { OpenAIFrontendAdapter } from 'ai.matey.frontend/openai';\nimport { AnthropicBackendAdapter } from 'ai.matey.backend/anthropic';\n\nconst bridge = new Bridge(\n  new OpenAIFrontendAdapter(),\n  new AnthropicBackendAdapter({ apiKey: 'your-key' })\n);\n\nconst response = await bridge.chat({\n  model: 'gpt-4',\n  messages: [{ role: 'user', content: 'Hello!' }]\n});\n"})}),"\n",(0,t.jsx)(n.h3,{id:"constructor",children:"Constructor"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-typescript",children:"constructor(\n  frontendAdapter: FrontendAdapter,\n  backendAdapter: BackendAdapter\n)\n"})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Parameters:"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"frontendAdapter"}),": Adapter that defines the input format (OpenAI, Anthropic, etc.)"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"backendAdapter"}),": Adapter that defines the AI provider (OpenAI, Anthropic, Gemini, etc.)"]}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"methods",children:"Methods"}),"\n",(0,t.jsx)(n.h4,{id:"chat",children:"chat()"}),"\n",(0,t.jsx)(n.p,{children:"Execute a non-streaming chat completion:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-typescript",children:"async chat(request: IRChatCompletionRequest): Promise<IRChatCompletionResponse>\n"})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Parameters:"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"request"}),": Chat completion request in the frontend adapter's format"]}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Returns:"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Promise resolving to the response in the frontend adapter's format"}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Example:"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-typescript",children:"const response = await bridge.chat({\n  model: 'gpt-4',\n  messages: [\n    { role: 'system', content: 'You are helpful.' },\n    { role: 'user', content: 'What is 2+2?' }\n  ],\n  temperature: 0.7,\n  max_tokens: 100\n});\n\nconsole.log(response.choices[0].message.content); // \"4\"\n"})}),"\n",(0,t.jsx)(n.h4,{id:"chatstream",children:"chatStream()"}),"\n",(0,t.jsx)(n.p,{children:"Execute a streaming chat completion:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-typescript",children:"async chatStream(request: IRChatCompletionRequest): Promise<AsyncIterable<IRChatCompletionChunk>>\n"})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Parameters:"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"request"}),": Chat completion request with ",(0,t.jsx)(n.code,{children:"stream: true"})]}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Returns:"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Promise resolving to an async iterable of response chunks"}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Example:"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-typescript",children:"const stream = await bridge.chatStream({\n  model: 'gpt-4',\n  messages: [{ role: 'user', content: 'Count to 5' }],\n  stream: true\n});\n\nfor await (const chunk of stream) {\n  const content = chunk.choices?.[0]?.delta?.content;\n  if (content) {\n    process.stdout.write(content);\n  }\n}\n"})}),"\n",(0,t.jsx)(n.h4,{id:"use",children:"use()"}),"\n",(0,t.jsx)(n.p,{children:"Add middleware to the request/response pipeline:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-typescript",children:"use(middleware: Middleware): void\n"})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Parameters:"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"middleware"}),": Middleware function or object"]}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Example:"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-typescript",children:"import { createLoggingMiddleware } from 'ai.matey.middleware';\n\nbridge.use(createLoggingMiddleware({ level: 'info' }));\nbridge.use(createCachingMiddleware({ ttl: 3600 }));\n"})}),"\n",(0,t.jsx)(n.h3,{id:"properties",children:"Properties"}),"\n",(0,t.jsx)(n.h4,{id:"frontendadapter",children:"frontendAdapter"}),"\n",(0,t.jsx)(n.p,{children:"The frontend adapter instance (read-only):"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-typescript",children:"readonly frontendAdapter: FrontendAdapter\n"})}),"\n",(0,t.jsx)(n.h4,{id:"backendadapter",children:"backendAdapter"}),"\n",(0,t.jsx)(n.p,{children:"The backend adapter instance (read-only):"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-typescript",children:"readonly backendAdapter: BackendAdapter\n"})}),"\n",(0,t.jsx)(n.h2,{id:"router",children:"Router"}),"\n",(0,t.jsx)(n.p,{children:"The Router extends Bridge functionality to support multiple backend adapters with intelligent routing strategies."}),"\n",(0,t.jsx)(n.h3,{id:"basic-usage-1",children:"Basic Usage"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-typescript",children:"import { Router } from 'ai.matey.core';\nimport { OpenAIFrontendAdapter } from 'ai.matey.frontend/openai';\nimport { AnthropicBackendAdapter } from 'ai.matey.backend/anthropic';\nimport { OpenAIBackendAdapter } from 'ai.matey.backend/openai';\n\nconst router = new Router(new OpenAIFrontendAdapter(), {\n  backends: [\n    new AnthropicBackendAdapter({ apiKey: process.env.ANTHROPIC_API_KEY }),\n    new OpenAIBackendAdapter({ apiKey: process.env.OPENAI_API_KEY })\n  ],\n  strategy: 'round-robin'\n});\n"})}),"\n",(0,t.jsx)(n.h3,{id:"constructor-1",children:"Constructor"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-typescript",children:"constructor(\n  frontendAdapter: FrontendAdapter,\n  options: RouterOptions\n)\n"})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Parameters:"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"frontendAdapter"}),": Frontend adapter instance"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"options"}),": Router configuration"]}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"routeroptions",children:"RouterOptions"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-typescript",children:"interface RouterOptions {\n  backends: BackendAdapter[];\n  strategy: 'round-robin' | 'priority' | 'random' | 'weighted' | 'custom';\n  customStrategy?: (request: IRChatCompletionRequest, backends: BackendAdapter[]) => number;\n  fallbackOnError?: boolean;\n  healthCheck?: {\n    enabled: boolean;\n    interval: number;\n    timeout?: number;\n  };\n}\n"})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Fields:"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"backends"}),": Array of backend adapter instances"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"strategy"}),": Routing strategy to use"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"customStrategy"}),": Custom routing function (required if strategy is 'custom')"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"fallbackOnError"}),": Automatically try next backend on failure (default: false)"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"healthCheck"}),": Health check configuration (optional)"]}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"routing-strategies",children:"Routing Strategies"}),"\n",(0,t.jsx)(n.h4,{id:"round-robin",children:"Round-Robin"}),"\n",(0,t.jsx)(n.p,{children:"Distributes requests evenly across all backends:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-typescript",children:"const router = new Router(new OpenAIFrontendAdapter(), {\n  backends: [backend1, backend2, backend3],\n  strategy: 'round-robin'\n});\n\n// Request 1 \u2192 backend1\n// Request 2 \u2192 backend2\n// Request 3 \u2192 backend3\n// Request 4 \u2192 backend1 (cycles)\n"})}),"\n",(0,t.jsx)(n.h4,{id:"priority",children:"Priority"}),"\n",(0,t.jsx)(n.p,{children:"Uses backends in order, falling back on failure:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-typescript",children:"const router = new Router(new OpenAIFrontendAdapter(), {\n  backends: [primaryBackend, secondaryBackend, tertiaryBackend],\n  strategy: 'priority',\n  fallbackOnError: true\n});\n\n// Always tries primaryBackend first\n// Falls back to secondaryBackend if primary fails\n// Falls back to tertiaryBackend if secondary fails\n"})}),"\n",(0,t.jsx)(n.h4,{id:"random",children:"Random"}),"\n",(0,t.jsx)(n.p,{children:"Randomly selects a backend for each request:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-typescript",children:"const router = new Router(new OpenAIFrontendAdapter(), {\n  backends: [backend1, backend2, backend3],\n  strategy: 'random'\n});\n"})}),"\n",(0,t.jsx)(n.h4,{id:"weighted",children:"Weighted"}),"\n",(0,t.jsx)(n.p,{children:"Distributes requests based on weights:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-typescript",children:"const router = new Router(new OpenAIFrontendAdapter(), {\n  backends: [\n    { backend: backend1, weight: 70 }, // 70% of traffic\n    { backend: backend2, weight: 20 }, // 20% of traffic\n    { backend: backend3, weight: 10 }  // 10% of traffic\n  ],\n  strategy: 'weighted'\n});\n"})}),"\n",(0,t.jsx)(n.h4,{id:"custom",children:"Custom"}),"\n",(0,t.jsx)(n.p,{children:"Implement your own routing logic:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-typescript",children:"const router = new Router(new OpenAIFrontendAdapter(), {\n  backends: [cheapBackend, fastBackend, powerfulBackend],\n  strategy: 'custom',\n  customStrategy: (request, backends) => {\n    // Route based on message length\n    const messageLength = JSON.stringify(request.messages).length;\n\n    if (messageLength < 100) return 0;  // Cheap\n    if (messageLength < 500) return 1;  // Fast\n    return 2;                            // Powerful\n  }\n});\n"})}),"\n",(0,t.jsx)(n.h3,{id:"methods-1",children:"Methods"}),"\n",(0,t.jsxs)(n.p,{children:["Router inherits all Bridge methods (",(0,t.jsx)(n.code,{children:"chat()"}),", ",(0,t.jsx)(n.code,{children:"chatStream()"}),", ",(0,t.jsx)(n.code,{children:"use()"}),") plus:"]}),"\n",(0,t.jsx)(n.h4,{id:"getbackendhealth",children:"getBackendHealth()"}),"\n",(0,t.jsx)(n.p,{children:"Get health status of all backends:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-typescript",children:"async getBackendHealth(): Promise<Record<string, BackendHealth>>\n"})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Returns:"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Object mapping backend names to health metrics"}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Example:"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-typescript",children:"const health = await router.getBackendHealth();\nconsole.log(health);\n/*\n{\n  anthropic: { healthy: true, latency: 1200, errorRate: 0 },\n  openai: { healthy: true, latency: 1500, errorRate: 0.02 },\n  groq: { healthy: false, latency: 5000, errorRate: 0.5 }\n}\n*/\n"})}),"\n",(0,t.jsx)(n.h3,{id:"events",children:"Events"}),"\n",(0,t.jsx)(n.p,{children:"Router emits events for monitoring:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-typescript",children:"router.on('backend:failed', ({ backend, error }) => {\n  console.log(`Backend ${backend} failed: ${error.message}`);\n});\n\nrouter.on('backend:switch', ({ from, to }) => {\n  console.log(`Switched from ${from} to ${to}`);\n});\n\nrouter.on('backend:health', ({ backend, healthy }) => {\n  console.log(`${backend}: ${healthy ? 'Healthy' : 'Unhealthy'}`);\n});\n"})}),"\n",(0,t.jsx)(n.h2,{id:"middleware-system",children:"Middleware System"}),"\n",(0,t.jsx)(n.p,{children:"Both Bridge and Router support middleware for intercepting and transforming requests/responses."}),"\n",(0,t.jsx)(n.h3,{id:"middleware-interface",children:"Middleware Interface"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-typescript",children:"interface Middleware {\n  name: string;\n  execute(\n    request: IRChatCompletionRequest,\n    next: (request: IRChatCompletionRequest) => Promise<IRChatCompletionResponse>\n  ): Promise<IRChatCompletionResponse>;\n}\n"})}),"\n",(0,t.jsx)(n.h3,{id:"creating-custom-middleware",children:"Creating Custom Middleware"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-typescript",children:"function createTimingMiddleware() {\n  return {\n    name: 'timing',\n    async execute(request, next) {\n      const start = Date.now();\n      const response = await next(request);\n      const duration = Date.now() - start;\n\n      console.log(`Request took ${duration}ms`);\n\n      return response;\n    }\n  };\n}\n\nbridge.use(createTimingMiddleware());\n"})}),"\n",(0,t.jsx)(n.h3,{id:"middleware-order",children:"Middleware Order"}),"\n",(0,t.jsx)(n.p,{children:"Middleware executes in reverse order (last added runs first):"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-typescript",children:"bridge.use(middleware1); // Runs 3rd\nbridge.use(middleware2); // Runs 2nd\nbridge.use(middleware3); // Runs 1st\n\n// Request \u2192 middleware3 \u2192 middleware2 \u2192 middleware1 \u2192 Backend\n// Response \u2190 middleware3 \u2190 middleware2 \u2190 middleware1 \u2190 Backend\n"})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Best practice order:"})}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsx)(n.li,{children:"Logging (first - sees everything)"}),"\n",(0,t.jsx)(n.li,{children:"Retry (second - handles failures)"}),"\n",(0,t.jsx)(n.li,{children:"Caching (third - caches successful responses)"}),"\n",(0,t.jsx)(n.li,{children:"Transform (fourth - modifies data)"}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"error-handling",children:"Error Handling"}),"\n",(0,t.jsx)(n.h3,{id:"error-types",children:"Error Types"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-typescript",children:"class BridgeError extends Error {\n  constructor(message: string, public code: string) {\n    super(message);\n    this.name = 'BridgeError';\n  }\n}\n"})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Error codes:"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"ADAPTER_ERROR"}),": Frontend/backend adapter error"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"VALIDATION_ERROR"}),": Invalid request format"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"NETWORK_ERROR"}),": Network/connection error"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"RATE_LIMIT_ERROR"}),": Rate limit exceeded"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"TIMEOUT_ERROR"}),": Request timeout"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"AUTH_ERROR"}),": Authentication failed"]}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"handling-errors",children:"Handling Errors"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-typescript",children:"try {\n  const response = await bridge.chat(request);\n} catch (error) {\n  if (error instanceof BridgeError) {\n    switch (error.code) {\n      case 'RATE_LIMIT_ERROR':\n        console.log('Rate limited, retrying...');\n        break;\n      case 'AUTH_ERROR':\n        console.log('Invalid API key');\n        break;\n      default:\n        console.log('Unknown error:', error.message);\n    }\n  }\n}\n"})}),"\n",(0,t.jsx)(n.h2,{id:"typescript-types",children:"TypeScript Types"}),"\n",(0,t.jsx)(n.h3,{id:"key-interfaces",children:"Key Interfaces"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-typescript",children:"// Request\ninterface IRChatCompletionRequest {\n  model: string;\n  messages: IRMessage[];\n  temperature?: number;\n  max_tokens?: number;\n  top_p?: number;\n  stream?: boolean;\n  tools?: IRTool[];\n  // ... more parameters\n}\n\n// Response\ninterface IRChatCompletionResponse {\n  id: string;\n  object: 'chat.completion';\n  created: number;\n  model: string;\n  choices: IRChoice[];\n  usage?: IRUsage;\n}\n\n// Message\ninterface IRMessage {\n  role: 'system' | 'user' | 'assistant' | 'tool';\n  content: string | IRContent[];\n  name?: string;\n}\n\n// Streaming chunk\ninterface IRChatCompletionChunk {\n  id: string;\n  object: 'chat.completion.chunk';\n  created: number;\n  model: string;\n  choices: IRStreamChoice[];\n}\n"})}),"\n",(0,t.jsxs)(n.p,{children:["See ",(0,t.jsx)(n.a,{href:"/guides/architecture/ir-format",children:"IR Format Documentation"})," for complete type definitions."]}),"\n",(0,t.jsx)(n.h2,{id:"best-practices",children:"Best Practices"}),"\n",(0,t.jsx)(n.h3,{id:"1-reuse-instances",children:"1. Reuse Instances"}),"\n",(0,t.jsx)(n.p,{children:"Create Bridge/Router instances once and reuse:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-typescript",children:"// \u2705 Good - reuse instance\nconst bridge = new Bridge(frontend, backend);\n\nasync function chat(message) {\n  return await bridge.chat({ model: 'gpt-4', messages: [{ role: 'user', content: message }] });\n}\n\n// \u274c Bad - creates new instance each call\nasync function chat(message) {\n  const bridge = new Bridge(frontend, backend);\n  return await bridge.chat({ model: 'gpt-4', messages: [{ role: 'user', content: message }] });\n}\n"})}),"\n",(0,t.jsx)(n.h3,{id:"2-use-typescript",children:"2. Use TypeScript"}),"\n",(0,t.jsx)(n.p,{children:"Take advantage of full type safety:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-typescript",children:"import type { IRChatCompletionRequest, IRChatCompletionResponse } from 'ai.matey.types';\n\nasync function chat(request: IRChatCompletionRequest): Promise<IRChatCompletionResponse> {\n  return await bridge.chat(request);\n}\n"})}),"\n",(0,t.jsx)(n.h3,{id:"3-handle-errors",children:"3. Handle Errors"}),"\n",(0,t.jsx)(n.p,{children:"Always wrap calls in try-catch:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-typescript",children:"try {\n  const response = await bridge.chat(request);\n  return response.choices[0].message.content;\n} catch (error) {\n  console.error('Chat failed:', error);\n  throw error;\n}\n"})}),"\n",(0,t.jsx)(n.h3,{id:"4-use-middleware",children:"4. Use Middleware"}),"\n",(0,t.jsx)(n.p,{children:"Add production features with middleware:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-typescript",children:"import { createLoggingMiddleware, createRetryMiddleware, createCachingMiddleware } from 'ai.matey.middleware';\n\nbridge.use(createLoggingMiddleware({ level: 'info' }));\nbridge.use(createRetryMiddleware({ maxAttempts: 3 }));\nbridge.use(createCachingMiddleware({ ttl: 3600 }));\n"})}),"\n",(0,t.jsx)(n.h2,{id:"see-also",children:"See Also"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.a,{href:"/packages/frontend",children:"Frontend Adapters"})," - Available frontend adapters"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.a,{href:"/packages/backend",children:"Backend Adapters"})," - Available backend adapters"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.a,{href:"/packages/middleware",children:"Middleware"})," - Available middleware"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.a,{href:"/guides/architecture/ir-format",children:"IR Format"})," - Intermediate representation details"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.a,{href:"/tutorials/beginner/simple-bridge",children:"Tutorial: Simple Bridge"})," - Step-by-step guide"]}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,a.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(o,{...e})}):o(e)}},1184:(e,n,r)=>{r.d(n,{R:()=>i,x:()=>d});var s=r(4041);const t={},a=s.createContext(t);function i(e){const n=s.useContext(a);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function d(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:i(e.components),s.createElement(a.Provider,{value:n},e.children)}}}]);